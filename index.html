<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sign in - Salam Pagar Nusa</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
    <style>
        /* CSS Styling (Tidak ada perubahan di sini dari versi sebelumnya) */
        :root {
            --primary-color: #6366f1; /* Warna ungu untuk tombol */
            --dark-bg: #1f2937; /* Warna latar belakang gelap untuk sisi kanan */
            --text-light: #f3f4f6;
            --text-dark: #374151;
            --error-color: #ef4444; /* Warna merah untuk pesan error */
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            background-color: #ffffff;
        }

        .container {
            display: flex;
            width: 100%;
            height: 100%;
        }

        /* --- Sisi Kiri: Formulir Sign In --- */
        .left-panel {
            flex: 1;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 40px;
        }

        .login-box {
            width: 100%;
            max-width: 400px;
            text-align: left;
        }

        .logo {
            margin-bottom: 20px;
            text-align: center;
        }

        .logo img {
            width: 80px;
            height: auto;
        }

        h1.signin-title {
            font-size: 2.5rem;
            font-weight: bold;
            color: var(--text-dark);
            margin-bottom: 5px;
            text-align: center;
        }

        .register-link {
            text-align: center;
            margin-bottom: 30px;
            color: var(--text-dark);
            font-size: 0.9rem;
        }

        .register-link a {
            color: var(--primary-color);
            text-decoration: none;
            font-weight: 600;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            font-size: 0.9rem;
            color: var(--text-dark);
            font-weight: 600;
            margin-bottom: 5px;
        }
        
        .password-input-group {
            position: relative;
            display: flex;
            align-items: center;
        }

        .form-control {
            width: 100%;
            padding: 12px 15px;
            border: 1px solid #d1d5db;
            border-radius: 8px;
            font-size: 1rem;
            outline: none;
            transition: border-color 0.3s;
        }
        
        .password-input-group .form-control {
            padding-right: 40px;
        }

        .password-toggle {
            position: absolute;
            right: 15px;
            cursor: pointer;
            color: #9ca3af;
        }
        
        .form-control.error {
            border-color: var(--error-color);
        }

        .error-message {
            color: var(--error-color);
            font-size: 0.85rem;
            margin-top: 5px;
            display: none;
        }
        
        .btn-signin {
            width: 100%;
            padding: 15px;
            background-color: var(--primary-color);
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 1.1rem;
            font-weight: bold;
            cursor: pointer;
            transition: background-color 0.3s;
            position: relative;
            overflow: hidden;
        }

        .btn-signin:hover {
            background-color: #4f46e5;
        }
        
        .spinner {
            display: none;
            border: 4px solid rgba(255, 255, 255, 0.3);
            border-top: 4px solid #fff;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            animation: spin 1s linear infinite;
            position: absolute;
            top: 50%;
            left: 50%;
            margin-top: -10px;
            margin-left: -10px;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .btn-signin.loading .btn-text {
            visibility: hidden;
        }
        
        .btn-signin.loading .spinner {
            display: block;
        }


        /* --- Sisi Kanan: Hero Section --- */
        .right-panel {
            flex: 1;
            background-color: var(--dark-bg);
            color: var(--text-light);
            display: flex;
            justify-content: center;
            align-items: center;
            text-align: left;
            padding: 40px;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='100%25' height='100%25' viewBox='0 0 1600 800'%3E%3Cg stroke='%23374151' stroke-width='60' %3E%3Cpath fill='%231f2937' d='M-100 200C-100 134 -46 80 20 80S160 134 160 200S106 320 40 320S-100 266 -100 200z' /%3E%3Cpath fill='%231f2937' d='M1500 600C1500 534 1446 480 1380 480S1240 534 1240 600S1294 720 1360 720S1500 666 1500 600z' /%3E%3C/g%3E%3Cg stroke='%23374151' stroke-width='40' %3E%3Cpath fill='%231f2937' d='M1100 -200C1100 -266 1046 -320 980 -320S840 -266 840 -200S894 -80 960 -80S1100 -134 1100 -200z' /%3E%3Cpath fill='%231f2937' d='M500 1000C500 934 446 880 380 880S240 934 240 1000S294 1120 360 1120S500 1066 500 1000z' /%3E%3C/g%3E%3C/svg%3E");
            background-size: cover;
            background-position: center;
        }

        .welcome-content {
            max-width: 500px;
        }

        h2.welcome-title {
            font-size: 4rem;
            font-weight: 800;
            line-height: 1.1;
            margin-bottom: 20px;
        }

        p.platform-desc {
            font-size: 1.25rem;
            color: #9ca3af;
        }

        /* Responsiveness */
        @media (max-width: 768px) {
            .container {
                flex-direction: column;
            }

            .right-panel {
                display: none;
            }

            .left-panel {
                min-height: 100vh;
            }

            h1.signin-title {
                font-size: 2rem;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="left-panel">
            <div class="login-box">
                <div class="logo">
                    <img src="logopn.png" alt="Logo Pagar Nusa">
                </div>
                
                <h1 class="signin-title">Selamat Datang</h1>
                
                <div class="register-link">
                    Belum punya akun? <a href="register.html">**Daftar Sekarang**</a>
                </div>

                <form id="signInForm">
                    <div class="form-group">
                        <label for="memberId">Nomor Induk Anggota*</label>
                        <input type="text" id="memberId" name="memberId" class="form-control" placeholder="Masukkan NIA/ID Anda" required>
                        <span class="error-message" data-for="memberId">NIA wajib diisi.</span>
                    </div>

                    <div class="form-group">
                        <label for="password">Kata Sandi*</label>
                        <div class="password-input-group">
                            <input type="password" id="password" name="password" class="form-control" placeholder="Masukkan Kata Sandi" required>
                            <i class="fas fa-eye password-toggle" onclick="togglePassword()"></i>
                        </div>
                        <span class="error-message" data-for="password">Kata Sandi wajib diisi.</span>
                    </div>
                    
                    <div style="text-align: right; margin-bottom: 25px;">
                        <a href="#" style="color: var(--primary-color); font-size: 0.85rem; text-decoration: none;">Lupa Kata Sandi?</a>
                    </div>

                    <button type="submit" class="btn-signin" id="submitBtn">
                        <span class="btn-text">Sign in</span>
                        <div class="spinner"></div>
                    </button>
                </form>
            </div>
        </div>

        <div class="right-panel">
            <div class="welcome-content">
                <h2 class="welcome-title">SELAMAT DATANG<br>PAGARNUSA UNUSIA</h2>
                <p class="platform-desc">Platform digital terpadu untuk administrasi anggota Pagar Nusa Universitas Nahdlatul Ulama Indonesia (UNUSIA).</p>
            </div>
        </div>
    </div>
    
    <script>
        const signInForm = document.getElementById('signInForm');
        const submitBtn = document.getElementById('submitBtn');
        const memberIdInput = document.getElementById('memberId');
        const passwordInput = document.getElementById('password');

        // *** SIMULASI DATABASE AKUN DAN DATA PROFIL ***
        const USER_DB = {
            // NIA Login: { password, profile: { data anggota } }
            '7602010603040006': {
                password: '123',
                profile: {
                    name: 'MUHAMMAD IBNU MUNDZIR',
                    nia: '86300408000001', // NIA Tampilan Sesuai Permintaan
                    domicile: 'Kabupaten Mamuju Tengah',
                    status: 'Aktif (Sejak 2022)',
                    // ✅ PERBAIKAN 1: Menggunakan jalur relatif ke folder lokal 
                    // '../' kembali ke root, lalu masuk ke folder 'foto-anggota'
                    photoUrl: '../foto-anggota/Muhammad Ibnu Mundzir.jpg' 
                }
            },
            '9876543210987654': { // Contoh akun lain
                password: 'anggota2',
                profile: {
                    name: 'DEDE AHMAD FAUZAN',
                    nia: '9876543210987654',
                    domicile: 'Kota Garut',
                    status: 'Aktif (Sejak 2023)',
                    // ✅ PERBAIKAN 2: Menggunakan jalur relatif untuk user kedua
                    photoUrl: '../foto-anggota/Dede Ahmad Fauzan.jpg'
                }
            }
        };
        // ************************************************

        function togglePassword() {
            const passwordField = document.getElementById('password');
            const toggleIcon = document.querySelector('.password-toggle');
            if (passwordField.type === 'password') {
                passwordField.type = 'text';
                toggleIcon.classList.remove('fa-eye');
                toggleIcon.classList.add('fa-eye-slash');
            } else {
                passwordField.type = 'password';
                toggleIcon.classList.remove('fa-eye-slash');
                toggleIcon.classList.add('fa-eye');
            }
        }

        // --- Fungsi Validasi & Submit ---
        function displayError(inputElement, message) {
            inputElement.classList.add('error');
            const errorElement = inputElement.closest('.form-group').querySelector('.error-message');
            if (errorElement) {
                errorElement.textContent = message;
                errorElement.style.display = 'block';
            }
        }

        function clearError(inputElement) {
            inputElement.classList.remove('error');
            const errorElement = inputElement.closest('.form-group').querySelector('.error-message');
            if (errorElement) {
                errorElement.style.display = 'none';
            }
        }

        function validateForm() {
            let isValid = true;
            clearError(memberIdInput);
            clearError(passwordInput);

            if (!memberIdInput.value.trim()) {
                displayError(memberIdInput, 'Nomor Induk Anggota wajib diisi.');
                isValid = false;
            }

            if (!passwordInput.value.trim()) {
                displayError(passwordInput, 'Kata Sandi wajib diisi.');
                isValid = false;
            }

            return isValid;
        }
        
        memberIdInput.addEventListener('input', () => clearError(memberIdInput));
        passwordInput.addEventListener('input', () => clearError(passwordInput));


        signInForm.addEventListener('submit', function(e) {
            e.preventDefault();

            if (validateForm()) {
                submitBtn.classList.add('loading');
                submitBtn.disabled = true;

                const nia = memberIdInput.value.trim();
                const password = passwordInput.value.trim();
                const userData = USER_DB[nia];

                setTimeout(() => {
                    submitBtn.classList.remove('loading');
                    submitBtn.disabled = false;
                    
                    // Cek apakah NIA terdaftar DAN password cocok
                    const isSuccess = userData && userData.password === password;

                    if (isSuccess) {
                        alert('Sign in Berhasil! Mengarahkan ke halaman profil...');
                        
                        // LOGIKA PENTING: SIMPAN DATA PROFIL KE LOCALSTORAGE
                        localStorage.setItem('loggedInUser', JSON.stringify(userData.profile));
                        
                        // ✅ PERBAIKAN 3: Pengalihan ke halaman profil di dalam subfolder
                        window.location.href = 'profilanggota/profilanggota.html'; 
                    } else {
                        // Tampilkan error jika kredensial salah
                        displayError(memberIdInput, 'NIA atau Kata Sandi salah.');
                        displayError(passwordInput, 'NIA atau Kata Sandi salah.');
                        // Menggunakan alert sebagai feedback terakhir
                        // alert('Sign in Gagal. NIA atau Kata Sandi salah.'); 
                    }

                }, 2000); // Simulasi waktu loading 2 detik
            }
        });
    </script>
</body>
</html>